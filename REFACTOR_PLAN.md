# å››å±‚æ¶æ„é‡æ„æ–¹æ¡ˆ (Core-App-Biz-Test)

## ğŸ¯ é‡æ„ç›®æ ‡
å°†å½“å‰é¡¹ç›®é‡æ„ä¸ºæ ‡å‡†çš„å››å±‚æµ‹è¯•æ¶æ„ï¼Œæå‡ä»£ç ç»„ç»‡æ€§ã€å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚

## ğŸ“‹ å½“å‰çŠ¶æ€åˆ†æ

### ä¼˜ç‚¹
- âœ… å·²æœ‰å››å±‚åŸºç¡€ç»“æ„
- âœ… åˆ†å±‚èŒè´£ç›¸å¯¹æ¸…æ™°  
- âœ… æœ‰å®Œæ•´çš„æ–‡æ¡£ä½“ç³»
- âœ… é›†æˆäº†æ€§èƒ½æµ‹è¯•å’Œç›‘æ§

### éœ€è¦ä¼˜åŒ–çš„ç‚¹
- ğŸ”§ å®Œå–„Coreå±‚çš„å·¥å…·æ¨¡å—
- ğŸ”§ æ ‡å‡†åŒ–Appå±‚çš„calleræ¨¡å¼
- ğŸ”§ å¢å¼ºBizå±‚çš„ä¸šåŠ¡ç¼–æ’èƒ½åŠ›
- ğŸ”§ ä¼˜åŒ–Testå±‚çš„ç”¨ä¾‹ç»„ç»‡
- ğŸ”§ ç»Ÿä¸€CLIå’Œè„šæ‰‹æ¶å·¥å…·

## ğŸ“ ç›®æ ‡æ¶æ„è®¾è®¡

```
test_platform/
â”œâ”€â”€ ğŸ“ nut_core/                    # ç¬¬ä¸€å±‚ï¼šç³»ç»Ÿåœ°åŸºå±‚
â”‚   â”œâ”€â”€ setup.py                    # ç‹¬ç«‹å®‰è£…åŒ…
â”‚   â””â”€â”€ src/nut_core/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ base_util/              # åŸºç¡€å·¥å…·
â”‚       â”‚   â”œâ”€â”€ config_handler.py   # é…ç½®ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ logger.py           # æ—¥å¿—ç³»ç»Ÿ
â”‚       â”‚   â”œâ”€â”€ retry_util.py       # é‡è¯•æœºåˆ¶
â”‚       â”‚   â””â”€â”€ wait_util.py        # ç­‰å¾…å·¥å…·
â”‚       â”œâ”€â”€ protocol/               # åè®®å°è£…
â”‚       â”‚   â”œâ”€â”€ http_handler.py     # HTTPå®¢æˆ·ç«¯
â”‚       â”‚   â”œâ”€â”€ ws_handler.py       # WebSocketå®¢æˆ·ç«¯
â”‚       â”‚   â””â”€â”€ auth_handler.py     # è®¤è¯å¤„ç†
â”‚       â”œâ”€â”€ db/                     # æ•°æ®åº“å·¥å…·
â”‚       â”‚   â”œâ”€â”€ mysql_handler.py    # MySQLæ“ä½œ
â”‚       â”‚   â”œâ”€â”€ redis_handler.py    # Redisæ“ä½œ
â”‚       â”‚   â””â”€â”€ es_handler.py       # Elasticsearchæ“ä½œ
â”‚       â”œâ”€â”€ mq/                     # æ¶ˆæ¯é˜Ÿåˆ—
â”‚       â”‚   â”œâ”€â”€ kafka_handler.py    # Kafkaæ“ä½œ
â”‚       â”‚   â””â”€â”€ rabbitmq_handler.py # RabbitMQæ“ä½œ
â”‚       â”œâ”€â”€ ui/                     # UIè‡ªåŠ¨åŒ–åŸºç¡€
â”‚       â”‚   â”œâ”€â”€ driver_factory.py   # é©±åŠ¨å·¥å‚
â”‚       â”‚   â”œâ”€â”€ browser_handler.py  # æµè§ˆå™¨æ“ä½œ
â”‚       â”‚   â””â”€â”€ element_handler.py  # å…ƒç´ æ“ä½œ
â”‚       â”œâ”€â”€ pytest_util/            # æµ‹è¯•å·¥å…·
â”‚       â”‚   â”œâ”€â”€ assertions.py       # æ–­è¨€å·¥å…·
â”‚       â”‚   â”œâ”€â”€ fixtures.py         # æµ‹è¯•å¤¹å…·
â”‚       â”‚   â””â”€â”€ marks.py            # æµ‹è¯•æ ‡è®°
â”‚       â””â”€â”€ cli/                    # è„šæ‰‹æ¶å·¥å…·
â”‚           â”œâ”€â”€ hammer.py           # ä»£ç ç”Ÿæˆå™¨
â”‚           â””â”€â”€ templates/          # æ¨¡æ¿æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“ nut_app/                     # ç¬¬äºŒå±‚ï¼šAPIå°è£…å±‚
â”‚   â”œâ”€â”€ setup.py
â”‚   â””â”€â”€ src/nut_app/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ enterprise/             # ä¼ä¸šAPIåŸŸ
â”‚       â”‚   â”œâ”€â”€ caller/             # APIè°ƒç”¨å™¨
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ user_caller.py
â”‚       â”‚   â”‚   â”œâ”€â”€ order_caller.py
â”‚       â”‚   â”‚   â””â”€â”€ product_caller.py
â”‚       â”‚   â”œâ”€â”€ constants/          # å¸¸é‡å®šä¹‰
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ urls.py
â”‚       â”‚   â”‚   â””â”€â”€ enums.py
â”‚       â”‚   â””â”€â”€ model/              # æ•°æ®æ¨¡å‹
â”‚       â”‚       â”œâ”€â”€ __init__.py
â”‚       â”‚       â”œâ”€â”€ user_model.py
â”‚       â”‚       â””â”€â”€ order_model.py
â”‚       â”œâ”€â”€ open_api/               # å¼€æ”¾APIåŸŸ
â”‚       â”‚   â”œâ”€â”€ caller/
â”‚       â”‚   â”œâ”€â”€ constants/
â”‚       â”‚   â””â”€â”€ model/
â”‚       â”œâ”€â”€ public_api/             # å…¬å…±APIåŸŸ
â”‚       â”‚   â”œâ”€â”€ caller/
â”‚       â”‚   â”œâ”€â”€ constants/
â”‚       â”‚   â””â”€â”€ model/
â”‚       â””â”€â”€ internal_api/           # å†…éƒ¨APIåŸŸ
â”‚           â”œâ”€â”€ caller/
â”‚           â”œâ”€â”€ constants/
â”‚           â””â”€â”€ model/
â”‚
â”œâ”€â”€ ğŸ“ nut_biz/                     # ç¬¬ä¸‰å±‚ï¼šä¸šåŠ¡ç¼–æ’å±‚
â”‚   â”œâ”€â”€ setup.py
â”‚   â””â”€â”€ src/nut_biz/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ enterprise/             # ä¼ä¸šä¸šåŠ¡åŸŸ
â”‚       â”‚   â”œâ”€â”€ biz_ops/            # ä¸šåŠ¡æ“ä½œ
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ user_flow.py    # ç”¨æˆ·ä¸šåŠ¡æµç¨‹
â”‚       â”‚   â”‚   â”œâ”€â”€ order_flow.py   # è®¢å•ä¸šåŠ¡æµç¨‹
â”‚       â”‚   â”‚   â””â”€â”€ payment_flow.py # æ”¯ä»˜ä¸šåŠ¡æµç¨‹
â”‚       â”‚   â”œâ”€â”€ checker/            # ä¸šåŠ¡æ£€æŸ¥å™¨
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ user_checker.py
â”‚       â”‚   â”‚   â””â”€â”€ order_checker.py
â”‚       â”‚   â”œâ”€â”€ fixed_data/         # å›ºå®šæµ‹è¯•æ•°æ®
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ users.py
â”‚       â”‚   â”‚   â””â”€â”€ orders.py
â”‚       â”‚   â”œâ”€â”€ request_body/       # è¯·æ±‚ä½“æ¨¡æ¿
â”‚       â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”‚   â”œâ”€â”€ user_requests.py
â”‚       â”‚   â”‚   â””â”€â”€ order_requests.py
â”‚       â”‚   â””â”€â”€ helper/             # è¾…åŠ©å·¥å…·
â”‚       â”‚       â”œâ”€â”€ __init__.py
â”‚       â”‚       â””â”€â”€ data_helper.py
â”‚       â”œâ”€â”€ open_api/               # å¼€æ”¾APIä¸šåŠ¡åŸŸ
â”‚       â”‚   â”œâ”€â”€ biz_ops/
â”‚       â”‚   â”œâ”€â”€ checker/
â”‚       â”‚   â””â”€â”€ fixed_data/
â”‚       â””â”€â”€ enterprise_ui/          # UIä¸šåŠ¡åŸŸ
â”‚           â”œâ”€â”€ page_objects/       # é¡µé¢å¯¹è±¡
â”‚           â”‚   â”œâ”€â”€ __init__.py
â”‚           â”‚   â”œâ”€â”€ login_page.py
â”‚           â”‚   â”œâ”€â”€ user_page.py
â”‚           â”‚   â””â”€â”€ order_page.py
â”‚           â””â”€â”€ step_definitions/   # æ­¥éª¤å®šä¹‰
â”‚               â”œâ”€â”€ __init__.py
â”‚               â”œâ”€â”€ user_steps.py
â”‚               â””â”€â”€ order_steps.py
â”‚
â”œâ”€â”€ ğŸ“ nut_test/                    # ç¬¬å››å±‚ï¼šæµ‹è¯•ç”¨ä¾‹å±‚
â”‚   â”œâ”€â”€ conftest.py                 # å…¨å±€æµ‹è¯•é…ç½®
â”‚   â””â”€â”€ domain/
â”‚       â”œâ”€â”€ enterprise/             # ä¼ä¸šåŸŸæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ conftest.py         # åŸŸçº§é…ç½®
â”‚       â”‚   â”œâ”€â”€ api/                # APIæµ‹è¯•
â”‚       â”‚   â”‚   â”œâ”€â”€ test_user_api.py
â”‚       â”‚   â”‚   â”œâ”€â”€ test_order_api.py
â”‚       â”‚   â”‚   â””â”€â”€ test_product_api.py
â”‚       â”‚   â”œâ”€â”€ scenario/           # åœºæ™¯æµ‹è¯•
â”‚       â”‚   â”‚   â”œâ”€â”€ test_user_journey.py
â”‚       â”‚   â”‚   â””â”€â”€ test_order_flow.py
â”‚       â”‚   â”œâ”€â”€ schemas/            # æ•°æ®æ¨¡å¼
â”‚       â”‚   â”‚   â”œâ”€â”€ user_schema.json
â”‚       â”‚   â”‚   â””â”€â”€ order_schema.json
â”‚       â”‚   â””â”€â”€ test_data/          # æµ‹è¯•æ•°æ®
â”‚       â”‚       â”œâ”€â”€ users.json
â”‚       â”‚       â””â”€â”€ orders.json
â”‚       â”œâ”€â”€ enterprise_ui/          # UIæµ‹è¯•åŸŸ
â”‚       â”‚   â”œâ”€â”€ conftest.py
â”‚       â”‚   â”œâ”€â”€ easyui/             # åŸºç¡€UIæµ‹è¯•
â”‚       â”‚   â”‚   â”œâ”€â”€ test_login.py
â”‚       â”‚   â”‚   â”œâ”€â”€ test_user.py
â”‚       â”‚   â”‚   â””â”€â”€ test_order.py
â”‚       â”‚   â””â”€â”€ features/           # BDDç‰¹æ€§æµ‹è¯•
â”‚       â”‚       â”œâ”€â”€ user_management.feature
â”‚       â”‚       â””â”€â”€ order_process.feature
â”‚       â””â”€â”€ open_api/               # å¼€æ”¾APIæµ‹è¯•
â”‚           â”œâ”€â”€ conftest.py
â”‚           â”œâ”€â”€ api/
â”‚           â””â”€â”€ scenario/
â”‚
â”œâ”€â”€ ğŸ“ easyuilib/                   # UIè‡ªåŠ¨åŒ–åº“(ç‹¬ç«‹)
â”‚   â”œâ”€â”€ setup.py
â”‚   â””â”€â”€ src/easyui/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ components/             # UIç»„ä»¶
â”‚       â”œâ”€â”€ locators/               # å®šä½å™¨
â”‚       â””â”€â”€ utils/                  # UIå·¥å…·
â”‚
â”œâ”€â”€ ğŸ“ perf/                        # æ€§èƒ½æµ‹è¯•(ç‹¬ç«‹)
â”‚   â”œâ”€â”€ k6/
â”‚   â”œâ”€â”€ prometheus/
â”‚   â””â”€â”€ grafana/
â”‚
â”œâ”€â”€ ğŸ“ config/                      # é…ç½®ç®¡ç†
â”œâ”€â”€ ğŸ“ cicd/                        # CI/CDé…ç½®
â”œâ”€â”€ ğŸ“ utils/                       # é€šç”¨å·¥å…·
â”œâ”€â”€ ğŸ“ cli/                         # å‘½ä»¤è¡Œå·¥å…·
â”œâ”€â”€ setup.py                        # é¡¶å±‚å®‰è£…é…ç½®
â”œâ”€â”€ requirements.txt                # ä¾èµ–ç®¡ç†
â”œâ”€â”€ develop.sh                      # å¼€å‘è„šæœ¬
â””â”€â”€ run_test.sh                     # æµ‹è¯•è„šæœ¬
```

## ğŸ”„ é‡æ„å®æ–½æ­¥éª¤

### Step 1: åˆ›å»ºç‹¬ç«‹åŒ…ç»“æ„
æ¯å±‚éƒ½æ˜¯ç‹¬ç«‹çš„PythonåŒ…ï¼Œæ”¯æŒå•ç‹¬å®‰è£…å’Œä¾èµ–ç®¡ç†

### Step 2: é‡æ–°ç»„ç»‡ä»£ç 
- Coreå±‚ï¼šåŸºç¡€å·¥å…·å’Œåè®®å°è£…
- Appå±‚ï¼šå„åŸŸçš„APIè°ƒç”¨å™¨
- Bizå±‚ï¼šä¸šåŠ¡æµç¨‹ç¼–æ’å’Œæ£€æŸ¥
- Testå±‚ï¼šæŒ‰åŸŸç»„ç»‡çš„æµ‹è¯•ç”¨ä¾‹

### Step 3: å»ºç«‹ä¾èµ–å…³ç³»
```
nut_test â†’ nut_biz â†’ nut_app â†’ nut_core
```

### Step 4: ç»Ÿä¸€å·¥å…·é›†æˆ
- è„šæ‰‹æ¶å·¥å…· (hamsterå‘½ä»¤)
- CLIå·¥å…·é›†æˆ
- æ€§èƒ½æµ‹è¯•é›†æˆ
- ç›‘æ§ç³»ç»Ÿé›†æˆ

## ğŸ¯ é‡æ„åçš„ä¼˜åŠ¿

1. **æ¸…æ™°çš„å±‚æ¬¡åˆ†ç¦»**: æ¯å±‚èŒè´£å•ä¸€ï¼Œä¾èµ–å…³ç³»æ¸…æ™°
2. **ç‹¬ç«‹åŒ…ç®¡ç†**: æ¯å±‚å¯ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²
3. **å¯æ‰©å±•æ€§**: æ–°å¢åŸŸæˆ–åŠŸèƒ½æ—¶ç»“æ„æ¸…æ™°
4. **å¯ç»´æŠ¤æ€§**: ä»£ç ç»„ç»‡æœ‰åºï¼Œæ˜“äºç»´æŠ¤
5. **å·¥å…·é›†æˆ**: ç»Ÿä¸€çš„CLIå’Œè„šæ‰‹æ¶å·¥å…·
6. **æ€§èƒ½ç›‘æ§**: é›†æˆK6+Prometheus+Grafana

## ğŸš€ ä½¿ç”¨æ–¹å¼

```bash
# 1. ä¸€é”®å¼€å‘ç¯å¢ƒæ­å»º
./develop.sh

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source nut_venv/bin/activate

# 3. ä½¿ç”¨è„šæ‰‹æ¶åˆ›å»ºæ–°åŸŸ
hamster new --domain payment --type api

# 4. è¿è¡Œæµ‹è¯•
pytest nut_test/domain/enterprise/api/

# 5. è¿è¡Œæ€§èƒ½æµ‹è¯•
./run_perf.sh

# 6. æŸ¥çœ‹ç›‘æ§
open http://localhost:3000  # Grafana
```